from Mits.Framers.IFramer  import IFramer


from Mits.Utils.General         import pack32L
from Mits.Framers.IFramer       import IFramer


class FramerQCExploit(IFramer):
    """
    Framer for QC Exploit, Add a constant at the beginning of each frame
    """


    name = "Exploit"
    
    def __init__(self, base, start_magic):
        IFramer.__init__(self, base)
        self.start_magic = pack32L(start_magic)
        
    def send(self, data):
        """ Append our magic at the beginning of the data """
        return self.base.send(self.start_magic + data)
